{% extends 'base.html' %}
{% block content %}
<div class="container mt-4">

    <!-- Back Button -->
    <div class="mb-4">
        <a href="{% url 'course_detail' lesson.module.course.id %}" class="btn btn-secondary">
            <i class="bi bi-arrow-left"></i> Back to Course
        </a>
    </div>

    <!-- Lesson Title -->
    <div class="mb-3">
        <h1 class="fw-bold">{{ lesson.title }}</h1>
        <p class="text-muted"><i class="bi bi-info-circle"></i> Content Type: {{ lesson_content.get_content_type_display }}</p>
    </div>

    <!-- Lesson Content -->
    {% if lesson_content.content_type == 'Video' %}
        <div class="card shadow-sm mb-4">
            <div class="card-header bg-primary text-white">
                <i class="bi bi-camera-video-fill"></i> Video Lesson
            </div>
            <div class="card-body p-0">
                <div class="ratio ratio-16x9">
                    <iframe src="{{ lesson_content.value }}" allowfullscreen class="rounded-bottom"></iframe>
                </div>
            </div>
        </div>

    {% elif lesson_content.content_type == 'Text' %}
        <div class="card shadow-sm mb-4">
            <div class="card-header bg-success text-white">
                <i class="bi bi-file-text-fill"></i> Text Lesson
            </div>
            <div class="card-body">
                <p>{{ lesson_content.value|linebreaksbr }}</p>
            </div>
        </div>

    {% elif lesson_content.content_type == 'PDF' %}
        <div class="card shadow-sm mb-4">
            <div class="card-header bg-info text-white">
                <i class="bi bi-file-earmark-pdf-fill"></i> PDF Lesson
            </div>
            <div class="card-body d-flex flex-column align-items-start">
                <p>Download or view the PDF document:</p>
                <a href="{{ lesson_content.value }}" target="_blank" class="btn btn-info">
                    <i class="bi bi-download"></i> View PDF
                </a>
            </div>
        </div>

    {% else %}
        <div class="alert alert-warning my-4">
            <i class="bi bi-exclamation-triangle-fill"></i> No content provided for this lesson.
        </div>
    {% endif %}

    <!-- Quiz Section -->
    {% if quiz %}
        <div class="card shadow-sm mb-4">
            <div class="card-header bg-warning text-dark">
                <i class="bi bi-question-circle-fill"></i> Quiz: {{ quiz.title }}
            </div>
            <div class="card-body d-flex justify-content-between align-items-center">
                {% if quiz_attempted %}
                    <p class="mb-0 text-muted">You have already completed this quiz.</p>
                    <a href="{% url 'take_quiz' quiz.id %}" class="btn btn-primary disabled">
                        <i class="bi bi-check-circle"></i> Completed
                    </a>
                {% else %}
                    <p class="mb-0">Test your knowledge with this quiz.</p>
                    <a href="{% url 'take_quiz' quiz.id %}" class="btn btn-primary">
                        <i class="bi bi-play-circle"></i> Take Quiz
                    </a>
                {% endif %}
            </div>
        </div>
    {% endif %}

    <!-- Assignment Section -->
    {% if assignment %}
        <div class="card shadow-sm mb-4">
            <div class="card-header bg-secondary text-white">
                <i class="bi bi-pencil-square"></i> Assignment: {{ assignment.title }}
            </div>
            <div class="card-body d-flex justify-content-between align-items-center">
                <p class="mb-0">{{ assignment.description }}</p>
                {% if assignment_submitted %}
                    <a href="{% url 'submit_assignment' assignment.id %}" class="btn btn-success disabled">
                        <i class="bi bi-check-circle"></i> Submitted
                    </a>
                {% else %}
                    <a href="{% url 'submit_assignment' assignment.id %}" class="btn btn-warning">
                        <i class="bi bi-upload"></i> Submit Assignment
                    </a>
                {% endif %}
            </div>
        </div>
    {% endif %}

</div>

<!-- Bootstrap Icons -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
{% endblock %}
