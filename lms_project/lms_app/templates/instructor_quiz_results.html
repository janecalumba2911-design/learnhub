{% extends 'base.html' %}
{% block content %}
<a href="{% url 'manage_course' course_id=quiz.lesson.module.course.id %}" class="btn btn-secondary mb-4">‚Üê Back to Course Management</a>

<h4 class="mb-4">Quiz Results: "{{ quiz.title }}"</h4>

{% if quiz_results %}
<div class="row g-4">
    {% for result in quiz_results %}
    <div class="col-lg-6 col-md-12">
        <div class="card shadow-sm h-100">
            <div class="card-header bg-primary text-white">
                {{ result.user.username }}
            </div>
            <div class="card-body">
                <p><strong>Score:</strong> {{ result.score }} / {{ quiz.total_marks }}</p>
                <p><strong>Percentage:</strong> {{ result.score_percentage }}%</p>
                
                <div class="progress mb-2" style="height: 20px;">
                    <div class="progress-bar 
                        {% if result.score_percentage >= 75 %}bg-success
                        {% elif result.score_percentage >= 50 %}bg-warning
                        {% else %}bg-danger{% endif %}" 
                        role="progressbar" 
                        style="width: {{ result.score_percentage }}%;" 
                        aria-valuenow="{{ result.score_percentage }}" 
                        aria-valuemin="0" aria-valuemax="100">
                        {{ result.score_percentage }}%
                    </div>
                </div>
                
                <small class="text-muted">Completed on: {{ result.completed_at|date:"M d, Y H:i" }}</small>
            </div>
        </div>
    </div>
    {% endfor %}
</div>
{% else %}
<div class="alert alert-info text-center mt-4">
    No quiz attempts found for this quiz yet.
</div>
{% endif %}

{% endblock %}
